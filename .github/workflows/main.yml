name: Build and push Web App to TdA

on:
  push:
    branches:
      - main

permissions:
        with:
          fetch-depth: 0

      - name: Remove nested template git repo to avoid submodule errors
        run: |
          if [ -d "predloha/TdA-react-express-mysql-template/.git" ]; then
            rm -rf predloha/TdA-react-express-mysql-template/.git
            echo "Removed nested .git directory from template.";
          fi

  contents: read

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Check Out Repo
        uses: actions/checkout@v4

      - name: Upload to TdA
        uses: Student-Cyber-Games/upload-app@tda-26
        with:
          tdc_token: ${{ secrets.TDC_TOKEN }}
